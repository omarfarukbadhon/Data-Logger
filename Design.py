# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'H:\Department\Hasan Sir\Design.ui'
#
# Created by: PyQt5 UI code generator 5.15.4
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.


from PyQt5 import QtCore, QtGui, QtWidgets
from PyQt5.QtCore import QTimer, QDateTime
import serial
import datetime
import glob
import xlsxwriter
import json
from tkinter import *
from tkinter import ttk
from tkinter.filedialog import asksaveasfile


class Ui_ESE(object):
    def setupUi(self, ESE):
        ESE.setObjectName("ESE")
        ESE.setEnabled(True)
        ESE.resize(1200, 800)
        ESE.setMinimumSize(QtCore.QSize(1200, 800))
        ESE.setMaximumSize(QtCore.QSize(1200, 800))
        ESE.setStyleSheet("background-color: rgb(43, 130, 130);\n"
"border-color: rgb(0, 103, 50);")
        self.label = QtWidgets.QLabel(ESE)
        self.label.setGeometry(QtCore.QRect(475, 50, 460, 100))
        self.label.setMinimumSize(QtCore.QSize(460, 100))
        self.label.setMaximumSize(QtCore.QSize(460, 100))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(64)
        font.setBold(True)
        font.setItalic(True)
        font.setWeight(75)
        self.label.setFont(font)
        self.label.setStyleSheet("color: rgb(0, 70, 0);")
        self.label.setObjectName("label")
        self.frame = QtWidgets.QFrame(ESE)
        self.frame.setGeometry(QtCore.QRect(20, 20, 210, 760))
        self.frame.setMinimumSize(QtCore.QSize(210, 760))
        self.frame.setMaximumSize(QtCore.QSize(210, 760))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.frame.setFont(font)
        self.frame.setStyleSheet("background-color: rgb(58, 175, 175);")
        self.frame.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.frame.setFrameShadow(QtWidgets.QFrame.Raised)
        self.frame.setObjectName("frame")
        self.label_2 = QtWidgets.QLabel(self.frame)
        self.label_2.setGeometry(QtCore.QRect(60, 180, 95, 30))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.label_2.setFont(font)
        self.label_2.setObjectName("label_2")
        self.com_combo = QtWidgets.QComboBox(self.frame)
        self.com_combo.setGeometry(QtCore.QRect(65, 230, 80, 30))
        self.com_combo.setMinimumSize(QtCore.QSize(80, 30))
        self.com_combo.setMaximumSize(QtCore.QSize(80, 30))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(14)
        self.com_combo.setFont(font)
        self.com_combo.setObjectName("com_combo")
        self.Connect = QtWidgets.QPushButton(self.frame)
        self.Connect.setGeometry(QtCore.QRect(60, 330, 95, 30))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(14)
        self.Connect.setFont(font)
        self.Connect.setObjectName("Connect")
        self.Disconnect = QtWidgets.QPushButton(self.frame)
        self.Disconnect.setGeometry(QtCore.QRect(60, 380, 95, 30))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(14)
        self.Disconnect.setFont(font)
        self.Disconnect.setObjectName("Disconnect")
        self.Save_data = QtWidgets.QPushButton(self.frame)
        self.Save_data.setGeometry(QtCore.QRect(60, 430, 95, 30))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(14)
        self.Save_data.setFont(font)
        self.Save_data.setObjectName("Save_data")
        self.label_3 = QtWidgets.QLabel(self.frame)
        self.label_3.setGeometry(QtCore.QRect(80, 530, 55, 30))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.label_3.setFont(font)
        self.label_3.setObjectName("label_3")
        self.Status = QtWidgets.QLabel(self.frame)
        self.Status.setGeometry(QtCore.QRect(50, 580, 120, 30))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.Status.setFont(font)
        self.Status.setObjectName("Status")
        self.label_4 = QtWidgets.QLabel(self.frame)
        self.label_4.setGeometry(QtCore.QRect(50, 640, 121, 30))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.label_4.setFont(font)
        self.label_4.setObjectName("label_4")
        self.Time = QtWidgets.QComboBox(self.frame)
        self.Time.setGeometry(QtCore.QRect(60, 690, 80, 30))
        self.Time.setMinimumSize(QtCore.QSize(80, 30))
        self.Time.setMaximumSize(QtCore.QSize(80, 30))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(14)
        self.Time.setFont(font)
        self.Time.setObjectName("Time")
        self.Time.addItem("")
        self.Time.addItem("")
        self.Time.addItem("")
        self.Time.addItem("")
        self.groupBox = QtWidgets.QGroupBox(ESE)
        self.groupBox.setGeometry(QtCore.QRect(280, 180, 420, 251))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.groupBox.setFont(font)
        self.groupBox.setObjectName("groupBox")
        self.Pressure = QtWidgets.QLabel(self.groupBox)
        self.Pressure.setGeometry(QtCore.QRect(30, 40, 150, 30))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(14)
        self.Pressure.setFont(font)
        self.Pressure.setObjectName("Pressure")
        self.Pressure_2 = QtWidgets.QLabel(self.groupBox)
        self.Pressure_2.setGeometry(QtCore.QRect(30, 90, 150, 30))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(14)
        self.Pressure_2.setFont(font)
        self.Pressure_2.setObjectName("Pressure_2")
        self.Pressure_3 = QtWidgets.QLabel(self.groupBox)
        self.Pressure_3.setGeometry(QtCore.QRect(30, 140, 150, 30))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(14)
        self.Pressure_3.setFont(font)
        self.Pressure_3.setObjectName("Pressure_3")
        self.Pressure_4 = QtWidgets.QLabel(self.groupBox)
        self.Pressure_4.setGeometry(QtCore.QRect(30, 190, 150, 30))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(14)
        self.Pressure_4.setFont(font)
        self.Pressure_4.setObjectName("Pressure_4")
        self.P1 = QtWidgets.QLabel(self.groupBox)
        self.P1.setGeometry(QtCore.QRect(210, 45, 50, 20))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.P1.setFont(font)
        self.P1.setObjectName("P1")
        self.P2 = QtWidgets.QLabel(self.groupBox)
        self.P2.setGeometry(QtCore.QRect(210, 95, 50, 20))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.P2.setFont(font)
        self.P2.setObjectName("P2")
        self.P3 = QtWidgets.QLabel(self.groupBox)
        self.P3.setGeometry(QtCore.QRect(210, 145, 50, 20))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.P3.setFont(font)
        self.P3.setObjectName("P3")
        self.P4 = QtWidgets.QLabel(self.groupBox)
        self.P4.setGeometry(QtCore.QRect(210, 195, 50, 20))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.P4.setFont(font)
        self.P4.setObjectName("P4")
        self.label_29 = QtWidgets.QLabel(self.groupBox)
        self.label_29.setGeometry(QtCore.QRect(300, 195, 50, 20))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.label_29.setFont(font)
        self.label_29.setObjectName("label_29")
        self.label_30 = QtWidgets.QLabel(self.groupBox)
        self.label_30.setGeometry(QtCore.QRect(300, 45, 50, 20))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.label_30.setFont(font)
        self.label_30.setObjectName("label_30")
        self.label_31 = QtWidgets.QLabel(self.groupBox)
        self.label_31.setGeometry(QtCore.QRect(300, 95, 50, 20))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.label_31.setFont(font)
        self.label_31.setObjectName("label_31")
        self.label_32 = QtWidgets.QLabel(self.groupBox)
        self.label_32.setGeometry(QtCore.QRect(300, 145, 50, 20))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.label_32.setFont(font)
        self.label_32.setObjectName("label_32")
        self.groupBox_2 = QtWidgets.QGroupBox(ESE)
        self.groupBox_2.setGeometry(QtCore.QRect(730, 180, 420, 251))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.groupBox_2.setFont(font)
        self.groupBox_2.setObjectName("groupBox_2")
        self.Flow_4 = QtWidgets.QLabel(self.groupBox_2)
        self.Flow_4.setGeometry(QtCore.QRect(30, 190, 150, 30))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(14)
        self.Flow_4.setFont(font)
        self.Flow_4.setObjectName("Flow_4")
        self.Flow_3 = QtWidgets.QLabel(self.groupBox_2)
        self.Flow_3.setGeometry(QtCore.QRect(30, 140, 150, 30))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(14)
        self.Flow_3.setFont(font)
        self.Flow_3.setObjectName("Flow_3")
        self.Flow_2 = QtWidgets.QLabel(self.groupBox_2)
        self.Flow_2.setGeometry(QtCore.QRect(30, 90, 150, 30))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(14)
        self.Flow_2.setFont(font)
        self.Flow_2.setObjectName("Flow_2")
        self.Flow = QtWidgets.QLabel(self.groupBox_2)
        self.Flow.setGeometry(QtCore.QRect(30, 40, 150, 30))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(14)
        self.Flow.setFont(font)
        self.Flow.setObjectName("Flow")
        self.label_33 = QtWidgets.QLabel(self.groupBox_2)
        self.label_33.setGeometry(QtCore.QRect(290, 45, 85, 20))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.label_33.setFont(font)
        self.label_33.setObjectName("label_33")
        self.F1 = QtWidgets.QLabel(self.groupBox_2)
        self.F1.setGeometry(QtCore.QRect(200, 45, 50, 20))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.F1.setFont(font)
        self.F1.setObjectName("F1")
        self.F2 = QtWidgets.QLabel(self.groupBox_2)
        self.F2.setGeometry(QtCore.QRect(200, 95, 50, 20))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.F2.setFont(font)
        self.F2.setObjectName("F2")
        self.label_36 = QtWidgets.QLabel(self.groupBox_2)
        self.label_36.setGeometry(QtCore.QRect(290, 195, 85, 20))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.label_36.setFont(font)
        self.label_36.setObjectName("label_36")
        self.F4 = QtWidgets.QLabel(self.groupBox_2)
        self.F4.setGeometry(QtCore.QRect(200, 195, 50, 20))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.F4.setFont(font)
        self.F4.setObjectName("F4")
        self.label_38 = QtWidgets.QLabel(self.groupBox_2)
        self.label_38.setGeometry(QtCore.QRect(290, 95, 85, 20))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.label_38.setFont(font)
        self.label_38.setObjectName("label_38")
        self.F3 = QtWidgets.QLabel(self.groupBox_2)
        self.F3.setGeometry(QtCore.QRect(200, 145, 50, 20))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.F3.setFont(font)
        self.F3.setObjectName("F3")
        self.label_40 = QtWidgets.QLabel(self.groupBox_2)
        self.label_40.setGeometry(QtCore.QRect(290, 145, 85, 20))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.label_40.setFont(font)
        self.label_40.setObjectName("label_40")
        self.groupBox_3 = QtWidgets.QGroupBox(ESE)
        self.groupBox_3.setGeometry(QtCore.QRect(280, 490, 871, 251))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.groupBox_3.setFont(font)
        self.groupBox_3.setObjectName("groupBox_3")
        self.Temperature_4 = QtWidgets.QLabel(self.groupBox_3)
        self.Temperature_4.setGeometry(QtCore.QRect(30, 200, 180, 30))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(14)
        self.Temperature_4.setFont(font)
        self.Temperature_4.setObjectName("Temperature_4")
        self.Temperature_3 = QtWidgets.QLabel(self.groupBox_3)
        self.Temperature_3.setGeometry(QtCore.QRect(30, 150, 180, 30))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(14)
        self.Temperature_3.setFont(font)
        self.Temperature_3.setObjectName("Temperature_3")
        self.Temperature_2 = QtWidgets.QLabel(self.groupBox_3)
        self.Temperature_2.setGeometry(QtCore.QRect(30, 100, 180, 30))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(14)
        self.Temperature_2.setFont(font)
        self.Temperature_2.setObjectName("Temperature_2")
        self.Temperature = QtWidgets.QLabel(self.groupBox_3)
        self.Temperature.setGeometry(QtCore.QRect(30, 50, 180, 30))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(14)
        self.Temperature.setFont(font)
        self.Temperature.setObjectName("Temperature")
        self.Temperature_8 = QtWidgets.QLabel(self.groupBox_3)
        self.Temperature_8.setGeometry(QtCore.QRect(450, 200, 180, 30))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(14)
        self.Temperature_8.setFont(font)
        self.Temperature_8.setObjectName("Temperature_8")
        self.Temperature_5 = QtWidgets.QLabel(self.groupBox_3)
        self.Temperature_5.setGeometry(QtCore.QRect(450, 50, 180, 30))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(14)
        self.Temperature_5.setFont(font)
        self.Temperature_5.setObjectName("Temperature_5")
        self.Temperature_6 = QtWidgets.QLabel(self.groupBox_3)
        self.Temperature_6.setGeometry(QtCore.QRect(450, 100, 180, 30))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(14)
        self.Temperature_6.setFont(font)
        self.Temperature_6.setObjectName("Temperature_6")
        self.Temperature_7 = QtWidgets.QLabel(self.groupBox_3)
        self.Temperature_7.setGeometry(QtCore.QRect(450, 150, 180, 30))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(14)
        self.Temperature_7.setFont(font)
        self.Temperature_7.setObjectName("Temperature_7")
        self.label_41 = QtWidgets.QLabel(self.groupBox_3)
        self.label_41.setGeometry(QtCore.QRect(320, 55, 80, 25))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.label_41.setFont(font)
        self.label_41.setObjectName("label_41")
        self.T1 = QtWidgets.QLabel(self.groupBox_3)
        self.T1.setGeometry(QtCore.QRect(240, 55, 50, 20))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.T1.setFont(font)
        self.T1.setObjectName("T1")
        self.T2 = QtWidgets.QLabel(self.groupBox_3)
        self.T2.setGeometry(QtCore.QRect(240, 105, 50, 20))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.T2.setFont(font)
        self.T2.setObjectName("T2")
        self.label_44 = QtWidgets.QLabel(self.groupBox_3)
        self.label_44.setGeometry(QtCore.QRect(320, 205, 80, 25))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.label_44.setFont(font)
        self.label_44.setObjectName("label_44")
        self.T4 = QtWidgets.QLabel(self.groupBox_3)
        self.T4.setGeometry(QtCore.QRect(240, 205, 50, 20))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.T4.setFont(font)
        self.T4.setObjectName("T4")
        self.label_46 = QtWidgets.QLabel(self.groupBox_3)
        self.label_46.setGeometry(QtCore.QRect(320, 105, 80, 25))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.label_46.setFont(font)
        self.label_46.setObjectName("label_46")
        self.T3 = QtWidgets.QLabel(self.groupBox_3)
        self.T3.setGeometry(QtCore.QRect(240, 155, 50, 20))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.T3.setFont(font)
        self.T3.setObjectName("T3")
        self.label_48 = QtWidgets.QLabel(self.groupBox_3)
        self.label_48.setGeometry(QtCore.QRect(320, 155, 80, 25))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.label_48.setFont(font)
        self.label_48.setObjectName("label_48")
        self.T8 = QtWidgets.QLabel(self.groupBox_3)
        self.T8.setGeometry(QtCore.QRect(650, 205, 50, 20))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.T8.setFont(font)
        self.T8.setObjectName("T8")
        self.T6 = QtWidgets.QLabel(self.groupBox_3)
        self.T6.setGeometry(QtCore.QRect(650, 105, 50, 20))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.T6.setFont(font)
        self.T6.setObjectName("T6")
        self.label_51 = QtWidgets.QLabel(self.groupBox_3)
        self.label_51.setGeometry(QtCore.QRect(730, 155, 80, 25))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.label_51.setFont(font)
        self.label_51.setObjectName("label_51")
        self.T7 = QtWidgets.QLabel(self.groupBox_3)
        self.T7.setGeometry(QtCore.QRect(650, 155, 50, 20))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.T7.setFont(font)
        self.T7.setObjectName("T7")
        self.label_53 = QtWidgets.QLabel(self.groupBox_3)
        self.label_53.setGeometry(QtCore.QRect(730, 205, 80, 25))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.label_53.setFont(font)
        self.label_53.setObjectName("label_53")
        self.label_54 = QtWidgets.QLabel(self.groupBox_3)
        self.label_54.setGeometry(QtCore.QRect(730, 55, 80, 25))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.label_54.setFont(font)
        self.label_54.setObjectName("label_54")
        self.T5 = QtWidgets.QLabel(self.groupBox_3)
        self.T5.setGeometry(QtCore.QRect(650, 55, 50, 20))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.T5.setFont(font)
        self.T5.setObjectName("T5")
        self.label_56 = QtWidgets.QLabel(self.groupBox_3)
        self.label_56.setGeometry(QtCore.QRect(730, 105, 80, 25))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(16)
        self.label_56.setFont(font)
        self.label_56.setObjectName("label_56")

        self.serial_ports()  # have to change
        self.save_variable = 0
        self.status = 0
        self.retranslateUi(ESE)
        QtCore.QMetaObject.connectSlotsByName(ESE)

    def retranslateUi(self, ESE):
        _translate = QtCore.QCoreApplication.translate
        ESE.setWindowTitle(_translate("ESE", "Form"))
        self.label.setText(_translate("ESE", "Data Logger"))
        self.label_2.setText(_translate("ESE", "COM Port"))
        self.Connect.setText(_translate("ESE", "Connect"))
        self.Disconnect.setText(_translate("ESE", "Disconnect"))
        self.Save_data.setText(_translate("ESE", "Save data"))
        self.label_3.setText(_translate("ESE", "Status"))
        self.Status.setText(_translate("ESE", "Disconnect"))
        self.label_4.setText(_translate("ESE", "Time Interval"))
        self.Time.setItemText(0, _translate("ESE", "1 Sec"))
        self.Time.setItemText(1, _translate("ESE", "2 Sec"))
        self.Time.setItemText(2, _translate("ESE", "5 Sec"))
        self.Time.setItemText(3, _translate("ESE", "10 Sec"))
        self.groupBox.setTitle(_translate("ESE", "Pressure Sensor"))
        self.Pressure.setText(_translate("ESE", "Pressure Sensor 01"))
        self.Pressure_2.setText(_translate("ESE", "Pressure Sensor 02"))
        self.Pressure_3.setText(_translate("ESE", "Pressure Sensor 03"))
        self.Pressure_4.setText(_translate("ESE", "Pressure Sensor 04"))
        self.P1.setText(_translate("ESE", "0.00"))
        self.P2.setText(_translate("ESE", "0.00"))
        self.P3.setText(_translate("ESE", "0.00"))
        self.P4.setText(_translate("ESE", "0.00"))
        self.label_29.setText(_translate("ESE", "atm"))
        self.label_30.setText(_translate("ESE", "atm"))
        self.label_31.setText(_translate("ESE", "atm"))
        self.label_32.setText(_translate("ESE", "atm"))
        self.groupBox_2.setTitle(_translate("ESE", "Flow Sensor"))
        self.Flow_4.setText(_translate("ESE", "Flow Sensor 04"))
        self.Flow_3.setText(_translate("ESE", "Flow Sensor 03"))
        self.Flow_2.setText(_translate("ESE", "Flow Sensor 02"))
        self.Flow.setText(_translate("ESE", "Flow Sensor 01"))
        self.label_33.setText(_translate("ESE", "Liter/min"))
        self.F1.setText(_translate("ESE", "0.00"))
        self.F2.setText(_translate("ESE", "0.00"))
        self.label_36.setText(_translate("ESE", "Liter/min"))
        self.F4.setText(_translate("ESE", "0.00"))
        self.label_38.setText(_translate("ESE", "Liter/min"))
        self.F3.setText(_translate("ESE", "0.00"))
        self.label_40.setText(_translate("ESE", "Liter/min"))
        self.groupBox_3.setTitle(_translate("ESE", "Temperature Sensor"))
        self.Temperature_4.setText(_translate("ESE", "Temperature Sensor 04"))
        self.Temperature_3.setText(_translate("ESE", "Temperature Sensor 03"))
        self.Temperature_2.setText(_translate("ESE", "Temperature Sensor 02"))
        self.Temperature.setText(_translate("ESE", "Temperature Sensor 01"))
        self.Temperature_8.setText(_translate("ESE", "Temperature Sensor 08"))
        self.Temperature_5.setText(_translate("ESE", "Temperature Sensor 05"))
        self.Temperature_6.setText(_translate("ESE", "Temperature Sensor 06"))
        self.Temperature_7.setText(_translate("ESE", "Temperature Sensor 07"))
        self.label_41.setText(_translate("ESE", "Degree C"))
        self.T1.setText(_translate("ESE", "0.00"))
        self.T2.setText(_translate("ESE", "0.00"))
        self.label_44.setText(_translate("ESE", "Degree C"))
        self.T4.setText(_translate("ESE", "0.00"))
        self.label_46.setText(_translate("ESE", "Degree C"))
        self.T3.setText(_translate("ESE", "0.00"))
        self.label_48.setText(_translate("ESE", "Degree C"))
        self.T8.setText(_translate("ESE", "0.00"))
        self.T6.setText(_translate("ESE", "0.00"))
        self.label_51.setText(_translate("ESE", "Degree C"))
        self.T7.setText(_translate("ESE", "0.00"))
        self.label_53.setText(_translate("ESE", "Degree C"))
        self.label_54.setText(_translate("ESE", "Degree C"))
        self.T5.setText(_translate("ESE", "0.00"))
        self.label_56.setText(_translate("ESE", "Degree C"))

        # have to change
        self.Disconnect.clicked.connect(self.endTimer)
        self.timer = QTimer()
        self.timer.timeout.connect(self.showTime)
        self.Connect.clicked.connect(self.startTimer)
        self.Save_data.clicked.connect(self.save)


    def startTimer(self):
            self.status = 1
            self.port = self.com_combo.currentText()
            self.ser = serial.Serial(self.port, 9600, timeout=10)
            self.interval = list(self.Time.currentText())
            # if int(self.interval[1]) == range(0, 9):
            #         self.stop = self.interval[0:1]
            #         # print(self.stop)
            #         delay = self.stop * 1000
            # else:
            #         self.stop = self.interval[0]
            #         # print(self.stop)
            #         delay = int(self.stop) * 1000
            self.stop = self.interval[0]
            # print(self.stop)
            delay = int(self.stop) * 1000
            self.timer.start(delay)
            self.Connect.setEnabled(False)
            self.Disconnect.setEnabled(True)

    def endTimer(self):

            self.Status.setText("Disconnected")
            if self.status == 2:
                    self.workbook.close()

            self.status = 0
            self.ser.close()
            self.timer.stop()
            self.save_variable = 0
            self.Connect.setEnabled(True)
            self.Disconnect.setEnabled(False)

    def showTime(self):
            time = QDateTime.currentDateTime()
            dateDisplay = time.toString('dd-MM-yy')
            timeDisplay = time.toString("hh:mm:ss")

            line = self.ser.readline()
            # print(line)

            self.dict_json = json.loads(line)
            print(self.dict_json)

            self.Show_Table()

            print(dateDisplay)
            print(timeDisplay)
            if self.status == 0:
                    self.Status.setText("Disconnected")

            elif self.status == 1:
                    self.Status.setText("Connected")

            elif self.status == 2:
                    self.Status.setText("Data storing")

    def save(self):
            if self.status == 1:
                    print("saving")
                    self.save_variable = 1
                    self.status = 2

    def Show_Table(self):
            print("showtime")
            self.P1.setText(str(self.dict_json.get("P1")))
            self.P2.setText(str(self.dict_json.get("P2")))
            self.P3.setText(str(self.dict_json.get("P3")))
            self.P4.setText(str(self.dict_json.get("P4")))
            self.T1.setText(str(self.dict_json.get("T1")))
            self.T2.setText(str(self.dict_json.get("T2")))
            self.T3.setText(str(self.dict_json.get("T3")))
            self.T4.setText(str(self.dict_json.get("T4")))
            self.T5.setText(str(self.dict_json.get("T5")))
            self.T6.setText(str(self.dict_json.get("T6")))
            self.T7.setText(str(self.dict_json.get("T7")))
            self.T8.setText(str(self.dict_json.get("T8")))
            if self.save_variable == 1:
                    print("ready ")
                    self.create_excel()

            if self.save_variable == 2:
                    print("data storing")
                    self.data_storing()

    def create_excel(self):
            # excel_name = str(datetime.datetime.now())
            # excel_name = excel_name.replace(".", " ").replace(":", "_")
            # excel_name = excel_name.split()
            # excel_name = "self.file" + excel_name[1] + ".xlsx"
            self.files = [('Excel Document', '*.xlsx')]
            self.file = asksaveasfile(filetypes=self.files, defaultextension=self.files)
            excel_name = self.file.name
            print(excel_name)
            self.workbook = xlsxwriter.Workbook(excel_name)
            self.worksheet = self.workbook.add_worksheet()
            self.bold = self.workbook.add_format({'bold': True})
            self.date_format = self.workbook.add_format({'num_format': 'dd/mm/yy hh:mm:ss'})
            self.x = 2
            self.worksheet.write('A1', 'TimeStamp', self.bold)
            self.worksheet.write('B1', 'pressure sensor 01', self.bold)
            self.worksheet.write('C1', 'pressure sensor 02', self.bold)
            self.worksheet.write('D1', 'pressure sensor 03', self.bold)
            self.worksheet.write('E1', 'pressure sensor 04', self.bold)
            self.worksheet.write('F1', 'Temperature sensor 01', self.bold)
            self.worksheet.write('G1', 'Temperature sensor 02', self.bold)
            self.worksheet.write('H1', 'Temperature sensor 03', self.bold)
            self.worksheet.write('I1', 'Temperature sensor 04', self.bold)
            self.worksheet.write('J1', 'Temperature sensor 05', self.bold)
            self.worksheet.write('K1', 'Temperature sensor 06', self.bold)
            self.worksheet.write('L1', 'Temperature sensor 07', self.bold)
            self.worksheet.write('M1', 'Temperature sensor 08', self.bold)

            print("created excel file")
            self.save_variable = 2

    def data_storing(self):
            print("storing in excel file")
            self.worksheet.write(self.x, 0, datetime.datetime.now(), self.date_format)
            self.worksheet.write(self.x, 1, float(self.dict_json.get("P1")))
            self.worksheet.write(self.x, 2, float(self.dict_json.get("P2")))
            self.worksheet.write(self.x, 3, float(self.dict_json.get("P3")))
            self.worksheet.write(self.x, 4, float(self.dict_json.get("P4")))
            self.worksheet.write(self.x, 5, float(self.dict_json.get("T1")))
            self.worksheet.write(self.x, 6, float(self.dict_json.get("T2")))
            self.worksheet.write(self.x, 7, float(self.dict_json.get("T3")))
            self.worksheet.write(self.x, 8, float(self.dict_json.get("T4")))
            self.worksheet.write(self.x, 9, float(self.dict_json.get("T5")))
            self.worksheet.write(self.x, 10, float(self.dict_json.get("T6")))
            self.worksheet.write(self.x, 11, float(self.dict_json.get("T7")))
            self.worksheet.write(self.x, 12, float(self.dict_json.get("T8")))
            self.x = self.x + 1

    def serial_ports(self):
            """ Lists serial port names

                :raises EnvironmentError:
                    On unsupported or unknown platforms
                :returns:
                    A list of the serial ports available on the system
            """
            if sys.platform.startswith('win'):
                    ports = ['COM%s' % (i + 1) for i in range(256)]
            elif sys.platform.startswith('linux') or sys.platform.startswith('cygwin'):
                    # this excludes your current terminal "/dev/tty"
                    ports = glob.glob('/dev/tty[A-Za-z]*')
            elif sys.platform.startswith('darwin'):
                    ports = glob.glob('/dev/tty.*')
            else:
                    raise EnvironmentError('Unsupported platform')

            self.result = []
            for port in ports:
                    try:
                            s = serial.Serial(port)
                            # print(s)
                            s.close()
                            self.result.append(port)
                    except (OSError, serial.SerialException):
                            pass
            for ele in self.result:
                    self.com_combo.addItem(str(ele))
                    print(ele)


if __name__ == "__main__":
    import sys
    app = QtWidgets.QApplication(sys.argv)
    ESE = QtWidgets.QWidget()
    ui = Ui_ESE()
    ui.setupUi(ESE)
    ESE.show()
    sys.exit(app.exec_())
